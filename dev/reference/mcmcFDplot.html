<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot First Differences from MCMC output — mcmcFDplot • BayesPostEst</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plot First Differences from MCMC output — mcmcFDplot" />
<meta property="og:description" content="R function to plot first differences generated from MCMC output.
For more on this method, see the documentation for mcmcFD(), Long (1997, 
Sage Publications), and King, Tomz, and Wittenberg (2000, American Journal 
of Political Science 44(2): 347-361). For a description of this type of plot,
see Figure 1 in Karreth (2018, International Interactions 44(3): 463-90)." />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BayesPostEst</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.3.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/getting_started.html">Using the BayesPostEst package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ShanaScogin/BayesPostEst/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot First Differences from MCMC output</h1>
    <small class="dont-index">Source: <a href='https://github.com/ShanaScogin/BayesPostEst/blob/master/R/mcmcFDplot.R'><code>R/mcmcFDplot.R</code></a></small>
    <div class="hidden name"><code>mcmcFDplot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>R function to plot first differences generated from MCMC output.
For more on this method, see the documentation for <code><a href='mcmcFD.html'>mcmcFD()</a></code>, Long (1997, 
Sage Publications), and King, Tomz, and Wittenberg (2000, American Journal 
of Political Science 44(2): 347-361). For a description of this type of plot,
see Figure 1 in Karreth (2018, International Interactions 44(3): 463-90).</p>
    </div>

    <pre class="usage"><span class='fu'>mcmcFDplot</span>(<span class='no'>fdfull</span>, <span class='kw'>ROPE</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>fdfull</th>
      <td><p>Output generated from <code><a href='mcmcFD.html'>mcmcFD(..., full_sims = TRUE)</a></code>.</p></td>
    </tr>
    <tr>
      <th>ROPE</th>
      <td><p>defaults to NULL. If not NULL, a numeric vector of length two, 
defining the Region of Practical Equivalence around 0. See Kruschke (2013, Journal of 
Experimental Psychology 143(2): 573-603) for more on the ROPE.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a density plot of the differences in probabilities. The plot is made with ggplot2 and can be
passed on as an object to customize. Annotated numbers show the percent of posterior draws with
the same sign as the median estimate (if <code>ROPE = NULL</code>) or on the same side of the 
ROPE as the median estimate (if <code>ROPE</code> is specified).</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>An R function to plot first differences after a Bayesian logit or probit model.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ul>
<li><p>Karreth, Johannes. 2018. “The Economic Leverage of International Organizations in Interstate Disputes.” 
International Interactions 44 (3): 463-90. https://doi.org/10.1080/03050629.2018.1389728.</p></li>
<li><p>King, Gary, Michael Tomz, and Jason Wittenberg. 2000. “Making the Most of Statistical 
Analyses: Improving Interpretation and Presentation.” American Journal of Political Science 
44 (2): 347–61. http://www.jstor.org/stable/2669316.</p></li>
<li><p>Kruschke, John K. 2013. “Bayesian Estimation Supersedes the T-Test.” Journal of 
Experimental Psychology: General 142 (2): 573–603. https://doi.org/10.1037/a0029146.</p></li>
<li><p>Long, J. Scott. 1997. Regression Models for Categorical and Limited Dependent Variables. 
Thousand Oaks: Sage Publications.</p></li>
</ul>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>.old_wd</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/getwd.html'>setwd</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span>())
<span class='co'># \donttest{</span>
<span class='co'>## simulating data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>123456</span>)
<span class='no'>b0</span> <span class='kw'>&lt;-</span> <span class='fl'>0.2</span> <span class='co'># true value for the intercept</span>
<span class='no'>b1</span> <span class='kw'>&lt;-</span> <span class='fl'>0.5</span> <span class='co'># true value for first beta</span>
<span class='no'>b2</span> <span class='kw'>&lt;-</span> <span class='fl'>0.7</span> <span class='co'># true value for second beta</span>
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>500</span> <span class='co'># sample size</span>
<span class='no'>X1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n</span>, -<span class='fl'>1</span>, <span class='fl'>1</span>)
<span class='no'>X2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n</span>, -<span class='fl'>1</span>, <span class='fl'>1</span>)
<span class='no'>Z</span> <span class='kw'>&lt;-</span> <span class='no'>b0</span> + <span class='no'>b1</span> * <span class='no'>X1</span> + <span class='no'>b2</span> * <span class='no'>X2</span>
<span class='no'>pr</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span> / (<span class='fl'>1</span> + <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(-<span class='no'>Z</span>)) <span class='co'># inv logit function</span>
<span class='no'>Y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span>(<span class='no'>n</span>, <span class='fl'>1</span>, <span class='no'>pr</span>)
<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='no'>X1</span>, <span class='no'>X2</span>, <span class='no'>Y</span>))

<span class='co'>## formatting the data for jags</span>
<span class='no'>datjags</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>as.list</a></span>(<span class='no'>data</span>)
<span class='no'>datjags</span>$<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>datjags</span>$<span class='no'>Y</span>)

<span class='co'>## creating jags model</span>
<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>()  {

  <span class='kw'>for</span>(<span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='no'>N</span>){
    <span class='no'>Y</span>[<span class='no'>i</span>] ~ <span class='fu'>dbern</span>(<span class='no'>p</span>[<span class='no'>i</span>])  <span class='co'>## Bernoulli distribution of y_i</span>
    <span class='fu'>logit</span>(<span class='no'>p</span>[<span class='no'>i</span>]) <span class='kw'>&lt;-</span> <span class='no'>mu</span>[<span class='no'>i</span>]    <span class='co'>## Logit link function</span>
    <span class='no'>mu</span>[<span class='no'>i</span>] <span class='kw'>&lt;-</span> <span class='no'>b</span>[<span class='fl'>1</span>] +
      <span class='no'>b</span>[<span class='fl'>2</span>] * <span class='no'>X1</span>[<span class='no'>i</span>] +
      <span class='no'>b</span>[<span class='fl'>3</span>] * <span class='no'>X2</span>[<span class='no'>i</span>]
  }

  <span class='kw'>for</span>(<span class='no'>j</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='fl'>3</span>){
    <span class='no'>b</span>[<span class='no'>j</span>] ~ <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>dnorm</a></span>(<span class='fl'>0</span>, <span class='fl'>0.001</span>) <span class='co'>## Use a coefficient vector for simplicity</span>
  }

}

<span class='no'>params</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"b"</span>)
<span class='no'>inits1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"b"</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>, <span class='fl'>3</span>))
<span class='no'>inits2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"b"</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>, <span class='fl'>3</span>))
<span class='no'>inits</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>inits1</span>, <span class='no'>inits2</span>)

<span class='co'>## fitting the model with R2jags</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>123</span>)
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>R2jags</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/R2jags/man/jags.html'>jags</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>datjags</span>, <span class='kw'>inits</span> <span class='kw'>=</span> <span class='no'>inits</span>,
                    <span class='kw'>parameters.to.save</span> <span class='kw'>=</span> <span class='no'>params</span>, <span class='kw'>n.chains</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>n.iter</span> <span class='kw'>=</span> <span class='fl'>2000</span>,
                    <span class='kw'>n.burnin</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>model.file</span> <span class='kw'>=</span> <span class='no'>model</span>)</div><div class='output co'>#&gt; Compiling model graph
#&gt;    Resolving undeclared variables
#&gt;    Allocating nodes
#&gt; Graph information:
#&gt;    Observed stochastic nodes: 500
#&gt;    Unobserved stochastic nodes: 3
#&gt;    Total graph size: 3506
#&gt; 
#&gt; Initializing model
#&gt; </div><div class='input'>
<span class='co'>## preparing data for mcmcFD()</span>
<span class='no'>xmat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span>(<span class='no'>Y</span> ~ <span class='no'>X1</span> + <span class='no'>X2</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>data</span>)
<span class='no'>mcmc</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>coda</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/mcmc.html'>as.mcmc</a></span>(<span class='no'>fit</span>)
<span class='no'>mcmc_mat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>mcmc</span>)[, <span class='fl'>1</span>:<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>xmat</span>)]

<span class='co'>## plotting with mcmcFDplot()</span>
<span class='no'>full</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mcmcFD.html'>mcmcFD</a></span>(<span class='kw'>modelmatrix</span> <span class='kw'>=</span> <span class='no'>xmat</span>,
               <span class='kw'>mcmcout</span> <span class='kw'>=</span> <span class='no'>mcmc_mat</span>,
               <span class='kw'>fullsims</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'>mcmcFDplot</span>(<span class='no'>full</span>)</div><div class='output co'>#&gt; <span class='message'>Picking joint bandwidth of 0.00785</span></div><div class='img'><img src='mcmcFDplot-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># }</span>

<span class='fu'><a href='https://rdrr.io/r/base/getwd.html'>setwd</a></span>(<span class='no'>.old_wd</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Johannes Karreth, Shana Scogin, Rob Williams, Andreas Beger.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


